"use strict";(self.webpackChunk_gravitational_teleport=self.webpackChunk_gravitational_teleport||[]).push([[456,179],{9161:(e,t,n)=>{n.d(t,{cZ:()=>k,cN:()=>_,fK:()=>E,$N:()=>g,ZP:()=>W});var r=n(2784),o=n(3980),i=n.n(o),s=n(917),c=n(3502);const a=["children","dialogCss"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}class d extends r.Component{render(){const e=this.props,{children:t,dialogCss:n}=e,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,a);return r.createElement(c.Z,f({role:"dialog"},o),r.createElement(h,null,r.createElement(m,{"data-testid":"dialogbox",dialogCss:n},t)))}}d.defaultProps={disableBackdropClick:!0,disableEscapeKeyDown:!0},d.propTypes=u(u({},c.Z.propTypes),{},{children:i().node,dialogCss:i().func});const h=s.ZP.div(["height:100%;outline:none;color:black;display:flex;align-items:center;justify-content:center;opacity:1;will-change:opacity;transition:opacity 225ms cubic-bezier(0.4,0,0.2,1) 0ms;"]),m=s.ZP.div(["padding:32px;padding-top:24px;background:",";color:",";border-radius:8px;box-shadow:0 8px 32px rgba(0,0,0,0.24);display:flex;flex-direction:column;position:relative;overflow-y:auto;max-height:calc(100% - 96px);",";"],(e=>e.theme.colors.primary.main),(e=>e.theme.colors.text.primary),(e=>e.dialogCss&&e.dialogCss(e)));var y=n(7294);function b(){return b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function g(e){return r.createElement(y.Z,b({typography:"h3",color:"text.primary",caps:!0},e))}var v=n(2865),w=n(9097);function O(){return O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O.apply(this,arguments)}function E(e){return r.createElement(x,O({minHeight:"32px",mb:"3",alignItems:"center"},e))}const x=(0,s.ZP)(w.Z)(["",""],v.cp);var P=n(7849);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const D=(0,s.ZP)(P.kC)([""]);D.defaultProps=j(j({},P.kC.defaultProps),{},{mb:"5",flex:"1",flexDirection:"column"});const k=D;function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const A=(0,s.ZP)(P.xu)([""]);A.defaultProps=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},P.xu.defaultProps);const _=A,W=d},1112:(e,t,n)=>{n.r(t),n.d(t,{default:()=>se});var r=n(2784),o=n(7849),i=n(9124),s=n(9161),c=n(2282),a=n(4523),l=n(4517),u=n(4696),p=n(2070),f=n(130),d=n(8230),h=n(3958),m=n(1727),y=n(1452),b=n(7278),g=n(3228),v=n(917),w=n(3757),O=n(7559),E=n(3937);function x(e){const{showShareDirectory:t,onShareDirectory:n,onDisconnect:i}=e;return r.createElement(o.kC,{alignItems:"center"},r.createElement(E.Oq,{buttonIconProps:{ml:4,size:0,color:"text.secondary",style:{fontSize:"20px"}},menuProps:P},t&&r.createElement(E.sN,{onClick:n},r.createElement(E.ZH,{as:w.GSs,mr:"2"}),"Share Directory (preview)"),r.createElement(E.sN,{onClick:i},r.createElement(E.ZH,{as:w.Lk_,mr:"2"}),"Disconnect")))}const P={menuListCss:()=>"\n  width: 250px;\n"},C=["item","onRemove","Icon","getColor","isAutoRemovable","autoRemoveDurationMs"];function j(){return j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j.apply(this,arguments)}function S(e){const{item:t,onRemove:n,Icon:i,getColor:s,isAutoRemovable:c,autoRemoveDurationMs:a}=e,l=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,C),[u,p]=(0,r.useState)(!1),[f,d]=(0,r.useState)(!1),h=(0,r.useRef)(),m=(0,v.Fg)();(0,r.useEffect)((()=>(!u&&c&&(h.current=setTimeout(n,a||1e4)),()=>{h.current&&clearTimeout(h.current)})),[u]);const y=r.createElement(o.Ei,{size:0,ml:1,mr:-1,style:{visibility:u?"visible":"hidden"},onClick:e=>{e.stopPropagation(),n()}},r.createElement(w.x8P,null));return r.createElement(L,j({py:2,pl:3,pr:2,onMouseOver:()=>{!1===u&&p(!0)},onMouseLeave:()=>{!0===u&&p(!1)},onClick:function(){d((e=>!e))}},l),r.createElement(o.kC,{alignItems:"center",mr:1,minWidth:"0",width:"100%"},r.createElement(i,{color:s(m),mr:3,fontSize:16}),function(e,t,n){const i=t?D:k;return"string"==typeof e?r.createElement(o.kC,{justifyContent:"space-between",width:"100%"},r.createElement(T,{typography:"body1",fontSize:13,lineHeight:20,$_css:i},e),n):"object"==typeof e?r.createElement(o.kC,{flexDirection:"column",minWidth:"0",width:"100%"},r.createElement(A,null,r.createElement(_,{fontSize:14,bold:!0,mr:"30px"},e.title),r.createElement(W,null,n)),r.createElement(Z,{fontSize:13,lineHeight:20,color:"text.secondary",$_css2:i},e.description)):void 0}(t.content,f,y)))}const D=(0,v.iv)(["line-height:20px;overflow-wrap:break-word;white-space:pre-line;"]),k=(0,v.iv)(["",";display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;"],D),L=(0,v.ZP)(o.kC)(["flex-direction:row;justify-content:space-between;background:",";min-height:40px;width:320px;box-shadow:0 4px 16px rgba(0,0,0,0.24);color:",";border-radius:4px;cursor:pointer;"],(e=>e.theme.colors.primary.light),(e=>e.theme.colors.text.primary));var T=(0,v.ZP)(o.xv)(["",""],(e=>e.$_css)),A=(0,v.ZP)("div")(["position:relative;"]),_=(0,v.ZP)(o.xv)(["line-height:20px;"]),W=(0,v.ZP)("div")(["position:absolute;top:0;right:0;"]),Z=(0,v.ZP)(o.xv)(["",""],(e=>e.$_css2)),M=n(9488);function R(e){let{warnings:t,onRemoveWarning:n}=e;const[i,s]=(0,r.useState)(!1),c=(0,r.useRef)(null),a=()=>{t.length>0&&s((e=>!e))};return 0===t.length&&i&&s(!1),function(e,t){(0,r.useEffect)((()=>{const n=n=>{e.current&&!e.current.contains(n.target)&&t()};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}(c,(()=>{s((e=>{if(e)return!1}))})),r.createElement($,{ref:c},r.createElement(N,{title:"Warnings",hasWarnings:t.length>0,px:2,onClick:a},r.createElement(o.kC,{alignItems:"center",justifyContent:"space-between"},r.createElement(I,{mr:2})," ",t.length)),i&&r.createElement(K,{mt:3,p:2,style:{maxHeight:window.innerHeight/4}},r.createElement(o.kC,{alignItems:"center",justifyContent:"space-between"},r.createElement(o.xv,{typography:"h6",px:3,style:{overflow:"visible"}},t.length," ",t.length>1?"Warnings":"Warning"),r.createElement(o.Ei,{size:1,ml:1,mr:2,onClick:a},r.createElement(w.x8P,null))),r.createElement(U,{flexWrap:"wrap",gap:2},t.map((e=>r.createElement(S,{key:e.id,item:e,onRemove:()=>n(e.id),Icon:w.v3j,getColor:e=>e.colors.warning,isAutoRemovable:!1}))))))}const I=(0,v.ZP)(w.v3j)(["font-weight:",";font-size:",";align-self:'center';"],(e=>{let{theme:t}=e;return t.fontWeights.bold}),(e=>{let{theme:t}=e;return t.fontSizes[2]+"px"})),N=(0,v.ZP)(o.zx)(["min-height:0;height:",";background-color:",";&:hover,&:focus{background-color:",";}"],(e=>{let{theme:t}=e;return t.fontSizes[7]+"px"}),(e=>e.hasWarnings?e.theme.colors.warning:e.theme.colors.action.disabled),(e=>e.hasWarnings?M.$y.A700:e.theme.colors.action.disabled)),K=(0,v.ZP)(o.Zb)(["display:flex;flex-direction:column;position:absolute;right:0;top:",";background-color:",";"],(e=>{let{theme:t}=e;return t.fontSizes[7]+"px"}),(e=>{let{theme:t}=e;return t.colors.primary.main})),$=v.ZP.div(["position:relative;"]),U=(0,v.ZP)(o.kC)(["overflow-y:auto;overflow-x:hidden;"]);function z(e){const{userHost:t,clipboardSharingEnabled:n,onDisconnect:i,canShareDirectory:s,isSharingDirectory:c,onShareDirectory:a,warnings:l,onRemoveWarning:u}=e,p=(0,v.Fg)(),f=e=>({color:e?p.colors.text.primary:p.colors.text.secondary});return r.createElement(o.tD,{height:`${F}px`,bg:O.O.dark,style:{justifyContent:"space-between"}},r.createElement(o.xv,{px:3,style:{color:p.colors.text.secondary}},t),r.createElement(o.kC,{px:3},r.createElement(o.kC,{alignItems:"center"},r.createElement(B,{style:f(c),pr:3,title:c?"Directory Sharing Enabled":"Directory Sharing Disabled"}),r.createElement(H,{style:f(n),pr:3,title:n?"Clipboard Sharing Enabled":"Clipboard Sharing Disabled"}),r.createElement(R,{warnings:l,onRemoveWarning:u})),r.createElement(x,{onDisconnect:i,showShareDirectory:s&&!c,onShareDirectory:a})))}const F=40,H=(0,v.ZP)(w.TUt)(["font-weight:",";font-size:",";align-self:'center';"],(e=>{let{theme:t}=e;return t.fontWeights.bold}),(e=>{let{theme:t}=e;return t.fontSizes[4]+"px"})),B=(0,v.ZP)(w.ot9)(["font-weight:",";font-size:",";align-self:'center';"],(e=>{let{theme:t}=e;return t.fontWeights.bold}),(e=>{let{theme:t}=e;return t.fontSizes[6]+"px"}));function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(){return{width:window.innerWidth,height:window.innerHeight-F}}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(){return re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},re.apply(this,arguments)}function oe(e){const{fetchAttempt:t,tdpConnection:n,disconnected:c,wsConnection:a,setTdpConnection:l,showAnotherSessionActiveDialog:u,setShowAnotherSessionActiveDialog:p}=e,f="processing"===t.status||"processing"===n.status,d=(()=>{const e="closed"===a&&!c&&("success"===n.status||""===n.status);let r="";return"failed"===t.status?r=t.statusText||"fetch attempt failed":"failed"===n.status?r=n.statusText||"tdp connection failed":""===n.status?r=n.statusText||"encountered a non-fatal error":e?r="Session disconnected for an unknown reason.":"processing"===t.status&&"success"===n.status&&(r="The application has detected an invalid internal application state.         Please file a bug report for this issue at         https://github.com/gravitational/teleport/issues/new?assignees=&labels=bug&template=bug_report.md"),{open:""!==r,text:r}})();if(d.open)return r.createElement(ie,re({},e,{initTdpCli:!1,displayCanvas:!1}),r.createElement(s.ZP,{dialogCss:()=>({width:"484px"}),onClose:()=>{l((e=>""===e.status?{status:"success"}:e))},open:d.open},r.createElement(s.fK,{style:{flexDirection:"column"}},r.createElement(s.$N,null,"Error")),r.createElement(s.cZ,null,r.createElement(r.Fragment,null,r.createElement(i.b0,{children:r.createElement(r.Fragment,null,d.text)}),"Refresh the page to try again.")),r.createElement(s.cN,null,r.createElement(o.PL,{size:"large",width:"30%",onClick:()=>{window.location.reload()}},"Refresh"))));if(u){const t=!1;return r.createElement(ie,re({},e,{initTdpCli:t,displayCanvas:!1}),r.createElement(s.ZP,{dialogCss:()=>({width:"484px"}),onClose:()=>{},open:!0},r.createElement(s.fK,{style:{flexDirection:"column"}},r.createElement(s.$N,null,"Another Session Is Active")),r.createElement(s.cZ,null,"This desktop has an active session, connecting to it may close the other session. Do you wish to continue?"),r.createElement(s.cN,null,r.createElement(o.DF,{mr:3,onClick:()=>{window.close()}},"Abort"),r.createElement(o.PL,{onClick:()=>{p(!1)}},"Continue"))))}if(c)return r.createElement(ie,re({},e,{initTdpCli:!1,displayCanvas:!1}),r.createElement(o.xu,{textAlign:"center",m:10},r.createElement(o.xv,null,"Session successfully disconnected")));if(f){const n="processing"!==t.status;return r.createElement(ie,re({},e,{initTdpCli:n,displayCanvas:!1}),r.createElement(o.xu,{textAlign:"center",m:10},r.createElement(o.z$,null)))}return r.createElement(ie,re({},e,{initTdpCli:!0,displayCanvas:!0}))}function ie(e){let{setDisconnected:t,webauthn:n,tdpClient:i,username:s,hostname:l,setClipboardSharingEnabled:u,directorySharingState:p,setDirectorySharingState:f,onPngFrame:d,onClipboardData:h,onTdpError:m,onTdpWarning:y,onWsClose:b,onWsOpen:g,onKeyDown:v,onKeyUp:w,onMouseMove:O,onMouseDown:E,onMouseUp:x,onMouseWheelScroll:P,onContextMenu:C,initTdpCli:j,displayCanvas:S,clipboardSharingEnabled:D,onShareDirectory:k,warnings:L,onRemoveWarning:T,children:A}=e;return r.createElement(o.kC,{flexDirection:"column"},r.createElement(z,{onDisconnect:()=>{t(!0),u(!1),f((e=>te(te({},e),{},{isSharing:!1}))),i.shutdown()},userHost:`${s}@${l}`,canShareDirectory:p.canShare,isSharingDirectory:p.isSharing,clipboardSharingEnabled:D,onShareDirectory:k,warnings:L,onRemoveWarning:T}),A,n.requested&&r.createElement(a.Z,{onContinue:n.authenticate,onCancel:()=>{n.setState((e=>te(te({},e),{},{errorText:'This session requires multi factor authentication to continue. Please hit "Retry" and follow the prompts given by your browser to complete authentication.'})))},errorText:n.errorText}),r.createElement(c.Z,{style:{display:S?"flex":"none",flex:1},tdpCli:i,tdpCliInit:j,tdpCliOnPngFrame:d,tdpCliOnClipboardData:h,tdpCliOnTdpError:m,tdpCliOnTdpWarning:y,tdpCliOnWsClose:b,tdpCliOnWsOpen:g,onKeyDown:v,onKeyUp:w,onMouseMove:O,onMouseDown:E,onMouseUp:x,onMouseWheelScroll:P,onContextMenu:C}))}const se=function(){const e=function(){const{attempt:e,run:t}=(0,u.Z)("processing"),{attempt:n,setAttempt:o}=(0,u.Z)("processing"),[i,s]=(0,r.useState)("closed"),[c,a]=(0,r.useState)(!1),[v,w]=(0,r.useState)({canShare:!1,isSharing:!1}),{username:O,desktopName:E,clusterId:x}=(0,l.UO)(),[P,C]=(0,r.useState)(""),j=navigator.userAgent.includes("Chrome"),[S,D]=(0,r.useState)(!1),[k,L]=(0,r.useState)(!1);document.title=(0,r.useMemo)((()=>`${x} â€¢ ${O}@${P}`),[x,P,O]),(0,r.useEffect)((()=>{t((()=>Promise.all([f.Z.fetchDesktop(x,E).then((e=>C(e.name))),d.ZP.fetchUserContext().then((e=>{D(e.acl.clipboardSharingEnabled&&j),w((t=>J(J({},t),{},{canShare:e.acl.directorySharingEnabled})))})),f.Z.checkDesktopIsActive(x,E).then((e=>{L(e)}))])))}),[x,E,j,t]);const[T,A]=(0,r.useState)([]),_=function(e){const{username:t,desktopName:n,clusterId:o,setTdpConnection:i,setWsConnection:s,setClipboardSharingEnabled:c,setDirectorySharingState:a,clipboardSharingEnabled:l,setWarnings:u}=e,[p,f]=(0,r.useState)(null),d=(0,r.useRef)(!1),v=(0,r.useRef)(new TextEncoder),w=(0,r.useRef)("");(0,r.useEffect)((()=>{const{width:e,height:r}=X(),i=b.Z.api.desktopWsAddr.replace(":fqdn",(0,y.Lp)()).replace(":clusterId",o).replace(":desktopName",n).replace(":token",(0,y.hP)()).replace(":username",t).replace(":width",e.toString()).replace(":height",r.toString());f(new m.pe(i))}),[o,t,n]);const{isMac:O}=(0,h.Z)(),E=(e,t)=>!("CapsLock"!==t.code||!O||(e.sendKeyboardInput(t.code,m.BN.DOWN),e.sendKeyboardInput(t.code,m.BN.UP),0)),x=e=>{l&&document.hasFocus()&&navigator.clipboard.readText().then((t=>{(0,g.Kp)(t,v.current).then((n=>{t&&n!==w.current&&(e.sendClipboardData({data:t}),w.current=n)}))}))};return{tdpClient:p,onPngFrame:(e,t)=>{d.current||((e=>{const{width:t,height:n}=X();e.width=t,e.height=n})(e.canvas),i({status:"success"}),d.current=!0),e.drawImage(t.data,t.left,t.top)},onTdpError:e=>{a((e=>Y(Y({},e),{},{isSharing:!1}))),c(!1),i({status:"failed",statusText:e.message})},onClipboardData:async e=>{if(l&&document.hasFocus()&&e.data){navigator.clipboard.writeText(e.data);let t=await(0,g.Kp)(e.data,v.current);w.current=t}},onWsClose:()=>{s("closed")},onWsOpen:()=>{s("open")},onKeyDown:(e,t)=>{t.preventDefault(),E(e,t)||(e.sendKeyboardInput(t.code,m.BN.DOWN),"MetaRight"!==t.code&&"MetaLeft"!==t.code&&"AltRight"!==t.code&&"AltLeft"!==t.code&&x(e))},onKeyUp:(e,t)=>{t.preventDefault(),E(e,t)||e.sendKeyboardInput(t.code,m.BN.UP)},onMouseMove:(e,t,n)=>{const r=t.getBoundingClientRect(),o=n.clientX-r.left,i=n.clientY-r.top;e.sendMouseMove(o,i)},onMouseDown:(e,t)=>{0!==t.button&&1!==t.button&&2!==t.button||e.sendMouseButton(t.button,m.BN.DOWN),x(e)},onMouseUp:(e,t)=>{0!==t.button&&1!==t.button&&2!==t.button||e.sendMouseButton(t.button,m.BN.UP)},onMouseWheelScroll:(e,t)=>{t.preventDefault(),t.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(t.deltaX&&e.sendMouseWheelScroll(m.Yc.HORIZONTAL,-t.deltaX),t.deltaY&&e.sendMouseWheelScroll(m.Yc.VERTICAL,-t.deltaY))},onContextMenu:()=>!1,onTdpWarning:e=>{u((t=>[...t,{content:e,severity:"warn",id:crypto.randomUUID()}]))}}}({username:O,desktopName:E,clusterId:x,setTdpConnection:o,setWsConnection:s,setClipboardSharingEnabled:D,setDirectorySharingState:w,clipboardSharingEnabled:S,setWarnings:A}),W=_.tdpClient,Z=(0,p.Z)(W);return J({hostname:P,username:O,clipboardSharingEnabled:S,setClipboardSharingEnabled:D,directorySharingState:v,setDirectorySharingState:w,isUsingChrome:j,fetchAttempt:e,tdpConnection:n,wsConnection:i,disconnected:c,setDisconnected:a,webauthn:Z,setTdpConnection:o,showAnotherSessionActiveDialog:k,setShowAnotherSessionActiveDialog:L,onShareDirectory:()=>{try{window.showDirectoryPicker().then((e=>{w((e=>J(J({},e),{},{isSharing:!0}))),W.addSharedDirectory(e),W.sendSharedDirectoryAnnounce()})).catch((e=>{w((e=>J(J({},e),{},{isSharing:!1}))),A((t=>[...t,{id:crypto.randomUUID(),severity:"warn",content:"Failed to open the directory picker: "+e.message}]))}))}catch(e){w((e=>J(J({},e),{},{isSharing:!1}))),A((t=>[...t,{id:crypto.randomUUID(),severity:"warn",content:"Encountered an error while attempting to share a directory: "+e.message+'. \n\nYour user role supports directory sharing over desktop access,           however this feature is only available by default on some Chromium           based browsers like Google Chrome or Microsoft Edge. Brave users can           use the feature by navigating to brave://flags/#file-system-access-api           and selecting "Enable". If you\'re not already, please switch to a supported browser.'}]))}},warnings:T,onRemoveWarning:e=>{A((t=>t.filter((t=>t.id!==e))))}},_)}();return r.createElement(oe,e)}},4523:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(2784),o=n(9161),i=n(9124),s=n(7849);const c=function(e){let{onContinue:t,onCancel:n,errorText:c}=e;return r.createElement(o.ZP,{dialogCss:()=>({width:"400px"}),open:!0},r.createElement(o.fK,{style:{flexDirection:"column"}},r.createElement(o.$N,{textAlign:"center"},"Verify Your Identity")),r.createElement(o.cZ,{mb:6},c&&r.createElement(i.b0,{mt:2,width:"100%"},c),r.createElement(s.xv,{textAlign:"center"},"Re-authentication is required. Follow the prompts given by your browser to complete authentication.")),r.createElement(o.cN,{textAlign:"center"},r.createElement(s.DF,{onClick:t,mr:3,width:"130px"},c?"Retry":"Verify"),r.createElement(s.PL,{onClick:n},"Cancel")))}},2070:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(2784),o=n(3094),i=n(9376);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e){const[t,n]=(0,r.useState)({requested:!1,errorText:"",publicKey:null}),s=e=>{const r=JSON.parse(e),o=(0,i.ee)(r).webauthnPublicKey;n(c(c({},t),{},{requested:!0,publicKey:o}))};return(0,r.useEffect)((()=>{if(e)return e.on(o.dw.WEBAUTHN_CHALLENGE,s),()=>{e.removeListener(o.dw.WEBAUTHN_CHALLENGE,s)}}),[e]),{errorText:t.errorText,requested:t.requested,authenticate:function(){if(window.PublicKeyCredential)navigator.credentials.get({publicKey:t.publicKey}).then((r=>{const o=(0,i.oH)(r);e.sendWebAuthn(o),n(c(c({},t),{},{requested:!1,errorText:""}))})).catch((e=>{n(c(c({},t),{},{errorText:e.message}))}));else{const e="This browser does not support WebAuthn required for hardware tokens,       please try the latest version of Chrome, Firefox or Safari.";n(c(c({},t),{},{errorText:e}))}},setState:n}}},3228:(e,t,n)=>{n.d(t,{ES:()=>s,Kp:()=>o,RB:()=>r,Sl:()=>i});const r=e=>{const t=document.createElement("a");t.setAttribute("href",`${e}`),t.setAttribute("target","_blank"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)};async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TextEncoder;const n=t.encode(e),r=await crypto.subtle.digest("SHA-256",n),o=Array.from(new Uint8Array(r)),i=o.map((e=>e.toString(16).padStart(2,"0"))).join("");return i}function i(e){let{authType:t,clusterId:n,username:r,accessRequestId:o}=e;const{hostname:i,port:s}=window.location;return`tsh login --proxy=${i}:${s||"443"} ${"local"===t?`--auth=${t} --user=${r} `:""}${n}${o?` --request-id=${o}`:""}`}function s(e,t){return e&&t?e.filter((e=>!t.includes(e))):[]}},2699:e=>{var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}m(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function a(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var o,i,s,l;if(c(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),s=i[t]),void 0===s)s=i[t]=n,++e._eventsCount;else if("function"==typeof s?s=i[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=a(e))>0&&s.length>o&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,l=u,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=u.bind(r);return o.listener=n,r.wrapFn=o,o}function f(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):h(o,o.length)}function d(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function h(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return a(this)},i.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var c=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw c.context=s,c}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)r(a,this,t);else{var l=a.length,u=h(a,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,o,i,s;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},i.prototype.listenerCount=d,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}}}]);